<div data-controller="lightbox" class="grid<%= " grid-cols-2" if media_attachments.length > 1 %> gap-x-1 gap-y-1 mt-4 rounded-lg overflow-hidden" data-lightbox-options-value='{"video":<%= media_attachments.any?(&:video?) %>}'>
  <% media_attachments.each_with_index do |media_attachment, i| %>
    <% if media_attachment.image? %>
      <%= link_to cdn_file_url(media_attachment), class: "relative#{" row-span-2" if i == 0 && media_attachments.length.odd?}" do %>
        <%= image_tag cdn_file_url(media_attachment), loading: "lazy", alt: (media_attachment.description || media_attachment.filename), class: "h-full object-cover max-h-[750px] hover:opacity-75" %>
      <% end %>
    <% elsif media_attachment.video? %>
      <% video_options = {source:[{src: cdn_file_url(media_attachment), type: media_attachment.content_type}], attributes: {preload: false, playsinline: true, controls: true}} %>

      <a class="group flex justify-center items-center cursor-pointer relative<%= " row-span-2" if i == 0 && media_attachments.length.odd? %>" data-lg-size="<%= [media_attachment.width.to_i, media_attachment.height.to_i].join("-") %>" data-video='<%= video_options.to_json %>' data-poster="<%= cdn_file_url(media_attachment.preview_image) %>">
        <button class="absolute z-10">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-16 h-16 rounded-full bg-white border-4 border-white fill-pink-500 hover:fill-pink-700"><path d="M512 256c0 141.4-114.6 256-256 256S0 397.4 0 256S114.6 0 256 0S512 114.6 512 256zM188.3 147.1c-7.6 4.2-12.3 12.3-12.3 20.9V344c0 8.7 4.7 16.7 12.3 20.9s16.8 4.1 24.3-.5l144-88c7.1-4.4 11.5-12.1 11.5-20.5s-4.4-16.1-11.5-20.5l-144-88c-7.4-4.5-16.7-4.7-24.3-.5z"/></svg>
        </button>

        <%= image_tag cdn_file_url(media_attachment.preview_image), loading: "lazy", alt: (media_attachment.description || media_attachment.filename), class: "h-full object-cover max-h-[750px] group-hover:opacity-75" %>
      </a>
    <% end %>
  <% end %>
</div>
